
## ğŸ“‹ Requirements DÃ©taillÃ©s des Voyages DÃ©mo

### ğŸ¯ **Objectif Principal**
ImplÃ©menter un recalage dynamique des dates des voyages de dÃ©monstration pour qu'ils soient toujours pertinents par rapport Ã  la date actuelle.

### ğŸ“… **SpÃ©cifications par Type de Voyage**

#### 1. **Voyage PassÃ© (Marrakech)**
- **Status :** `'past'`
- **Nouvelle date de dÃ©but :** `maintenant - 37 jours`
- **Nouvelle date de fin :** `maintenant - 30 jours`
- **Objectif :** Voyage terminÃ© il y a environ 1 semaine

#### 2. **Voyage Futur (MontrÃ©al)**
- **Status :** `'upcoming'`
- **Nouvelle date de dÃ©but :** `maintenant + 60 jours`
- **Nouvelle date de fin :** `maintenant + 67 jours`
- **Objectif :** Voyage prÃ©vu dans environ 2 mois

#### 3. **Voyage en Cours (AthÃ¨nes)**
- **Status :** `'ongoing'`
- **Logique spÃ©ciale :**
  1. Identifier le **premier vol** (le plus ancien)
  2. Calculer sa **durÃ©e** = `originalEnd - originalStart`
  3. Positionner son nouveau dÃ©part Ã  `maintenant - durÃ©e/3`
  4. Calculer l'**offset** = `newFirstFlightStart - originalFirstFlightStart`
  5. **Appliquer cet offset Ã  toutes les dates** du voyage
- **Objectif :** Vol en cours maintenant, avec 1/3 du temps Ã©coulÃ©

### ğŸ”§ **Contraintes Techniques**

#### **Identification des Voyages**
- **Avant :** Recherche par titre (recherche partielle)
- **AprÃ¨s :** Identification par champ `status`
  ```typescript
  const pastTplSrc = rawTrips.find(t => t['status'] === 'past');
  const ongoingTplSrc = rawTrips.find(t => t['status'] === 'ongoing');
  const futureTplSrc = rawTrips.find(t => t['status'] === 'upcoming');
  ```

#### **CohÃ©rence des Fuseaux Horaires**
- Conservation des **horaires relatifs** entre les plans
- Respect des **fuseaux horaires d'origine** pour chaque plan
- Pas de modification des **durÃ©es** des activitÃ©s

#### **Gestion des Erreurs**
- Log explicite si un voyage template manque
- Retour des donnÃ©es brutes en cas d'erreur
- Identification prÃ©cise des voyages manquants

### ğŸ“Š **Exemple de Calculs**

Avec `now = 2025-07-04T12:00:00Z` :

#### **Voyage PassÃ© (Marrakech)**
- **Nouvelles dates :** 2025-05-28 â†’ 2025-06-04
- **Offset :** +408 jours
- **VÃ©rification :** âœ… Respecte les requirements

#### **Voyage Futur (MontrÃ©al)**
- **Nouvelles dates :** 2025-09-02 â†’ 2025-09-09
- **Offset :** -8 jours
- **VÃ©rification :** âœ… Respecte les requirements

#### **Voyage en Cours (AthÃ¨nes)**
- **Vol positionnÃ© :** 2025-07-04T10:50:00Z â†’ 2025-07-04T14:20:00Z
- **Temps Ã©coulÃ© :** 1.2 heures
- **Temps restant :** 2.3 heures
- **VÃ©rification :** âœ… Vol en cours maintenant

###    **Corrections SupplÃ©mentaires ImplÃ©mentÃ©es**

#### **Correction des Heures d'ActivitÃ©s**
- **ProblÃ¨me :** ActivitÃ©s programmÃ©es entre 22h et 6h du matin
- **Solution :** DÃ©placement automatique Ã  10h00 du matin
- **PrÃ©servation :** DurÃ©e de l'activitÃ© maintenue

#### **Gestion des Fuseaux Horaires**
- **Ajout :** Mapping JTR â†’ Europe/Athens pour Santorini
- **AmÃ©lioration :** Affichage des fuseaux horaires locaux
- **Correction :** Ã‰viter l'affichage UTC par dÃ©faut

### ğŸ”„ **Ordre d'ExÃ©cution**
1. **Recalage dynamique** selon les spÃ©cifications
2. **Correction des heures d'activitÃ©s** (22h-6h â†’ 10h00)
3. **Enrichissement des fuseaux horaires**
4. **Tri chronologique** final des plans

Ces requirements garantissent que les voyages de dÃ©mo sont toujours pertinents et affichent des informations rÃ©alistes, peu importe quand l'utilisateur consulte l'application !


EN RESUME : juste une prÃ©cision, je veux juste qu'il y aie un voyage dans le passÃ© (peu importe la date), un dans le futur, peu importe la date, un voyage en cours: dans ce cas prÃ©cis, je veux que le premier vol soit positionnÃ© Ã  1/3 de son vol. Le reste des dates et heures doivent Ãªtre calculÃ©es en fonction de ce critÃ¨re. Et les heures des plans doivent Ãªtre rÃ©alistes (pas de visite Ã  2h du matin par exemple). Les heures doivent Ãªtre exprimÃ©e dans le fuseau horaire de l'endroit oÃ¹ Ã§a se passe. Tous les plans doivent Ãªtre triÃ©s par ordre chronologique.