// ğŸŸ¡ PROMPT COMPLET POUR CURSOR â€“ INTÃ‰GRATION PARSING D'EMAILS DANS BoredOnBoardIonic

/*
Objectif : ajouter au projet Angular/Ionic (BoredOnBoardIonic) un systÃ¨me backend + frontend permettant de :
- Lire automatiquement les e-mails non lus adressÃ©s Ã  bobplans@sunshine-adventures.net (Zoho Mail, IMAP)
- Parser leur contenu via OpenAI (clÃ© dans .env) pour produire un JSON structurÃ©
- Sauvegarder ce JSON localement
- Permettre l'affichage de ces donnÃ©es dans l'application Ionic (type de contenu, dÃ©tails, recherche, etc.)

ğŸ“ Structure du projet dÃ©jÃ  en place (racine) :
- frontend : `/src`
- scripts utils : `/scripts`
- .env dÃ©jÃ  prÃ©sent
- pas de dossier backend existant, mais possibilitÃ© dâ€™en crÃ©er un (ex: `/email-parser`)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ§  CE QUE CURSOR DOIT FAIRE :

### 1. ğŸ”§ Backend - CrÃ©ation du module `email-parser`
CrÃ©er un dossier `email-parser/` Ã  la racine avec :

- `imap.service.ts` : Connexion IMAP Ã  Zoho Mail (imap.zoho.eu:993) pour l'adresse `bobplans@sunshine-adventures.net`. Lire tous les e-mails **non lus**, les parser avec `mailparser`, puis les marquer comme lus.

- `openai.service.ts` : Utilise `openai` (GPT-4) pour transformer l'email brut en JSON structurÃ©.
  - Lâ€™appel doit contenir un prompt du style :
    "Extract structured booking data (type, provider, reference, name, dates, price, address...) from the email below and return JSON only."

- `storage.service.ts` : Sauvegarde le JSON dans `./parsed-emails/booking_<timestamp>.json` (crÃ©er le dossier s'il nâ€™existe pas).

- `index.ts` : Point dâ€™entrÃ©e qui appelle les services ci-dessus et boucle sur tous les emails non lus.

- `.env` doit contenir :
```env
IMAP_USER=bobplans@sunshine-adventures.net
IMAP_PASS=HzCXsEafd6PK
IMAP_HOST=imap.zoho.eu
IMAP_PORT=993
OPENAI_API_KEY=sk-...
```

- Ajouter un script `scripts/parse-mails.js` :
```ts
import { parseEmails } from '../email-parser';
parseEmails().then(() => console.log('Parsing done')).catch(console.error);
```

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

### 2. ğŸŒ Endpoint REST (optionnel mais utile)
Dans `server.js`, exposer un endpoint `/api/parse-mails` qui appelle `parseEmails()` pour dÃ©clencher le parsing depuis le frontend.

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

### 3. ğŸ“± Frontend Ionic - Page `parsed-mails`
CrÃ©er un dossier `/src/app/pages/parsed-mails/` avec :

- `parsed-mails.page.ts/html/scss/module.ts` pour :
  - Lister tous les fichiers JSON dans `parsed-emails/` (via un appel REST ou lecture locale)
  - Afficher pour chaque entrÃ©e : `type`, `provider`, `reference_number`, `location`, `dates`, etc.
  - Affichage format clÃ©/valeur en accordÃ©on ou carte
  - Barre de recherche (filtrage par `booking_type`, ex: flight, hotel...)

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

### ğŸ” Exemple de JSON attendu :
```json
{
  "booking_type": "hotel",
  "provider": "Booking.com",
  "reference_number": "4709721403",
  "location": "Frascati",
  "checkin_date": "2025-06-20",
  "checkout_date": "2025-06-22",
  "name": "Hotel & Spa Villa Mercede",
  "price": 400,
  "currency": "EUR",
  "address": "Via Tuscolana 20, Frascati, 00044, Italie",
  "contact_info": {
    "phone": "+390699291979"
  }
}
```

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

### âœ… Contraintes :
- Utiliser TypeScript partout
- Utiliser `mailparser` pour lire les emails
- Utiliser `openai` pour lâ€™analyse
- Utiliser `fs` pour Ã©crire les fichiers JSON
- Les nouveaux fichiers doivent sâ€™intÃ©grer proprement au projet sans casser lâ€™existant

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â¡ï¸ Fin du prompt â€“ GÃ©nÃ¨re maintenant tous les fichiers nÃ©cessaires (backend et frontend) en respectant cette architecture.
