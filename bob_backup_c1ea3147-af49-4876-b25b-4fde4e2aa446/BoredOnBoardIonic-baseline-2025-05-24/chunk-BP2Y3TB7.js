import{a as te,b as ie}from"./chunk-H73OQI6D.js";import{a as ee}from"./chunk-77SYAVCL.js";import{B as J,C as Z,F as $,c as B,f as k,g as N,l as V,m as F,n as q,o as j,p as K,q as Q,r as X,x as Y,y as z,z as G}from"./chunk-V5B2KLGN.js";import"./chunk-F6L3CC75.js";import{F as A,J as O,T as U}from"./chunk-HLI2QS3U.js";import{$ as h,$a as H,Da as y,H as e,I as _,Ja as b,K as T,Oa as v,P as R,S as s,Sa as x,U as o,V as i,W as g,Ya as D,aa as S,db as L,eb as W,ia as l,ja as m,ka as M,ma as E,na as C,oa as I,ra as d,sa as p}from"./chunk-GCV73WN4.js";import"./chunk-PTOT3QKV.js";import"./chunk-B5GAGNNW.js";import"./chunk-7CZIZFFD.js";import"./chunk-IFM5WRZ2.js";import"./chunk-HC6MZPB3.js";import"./chunk-IP3IRUG3.js";import"./chunk-EX3LFGLF.js";import"./chunk-RMJ7PCZJ.js";import"./chunk-OFKYDT3Y.js";import"./chunk-SJBLRW5X.js";import"./chunk-JFFBAPXU.js";import"./chunk-MCRJI3T3.js";import"./chunk-BBW2JLGN.js";import"./chunk-B7L6ZJ5P.js";import"./chunk-KLLAU2Z6.js";import"./chunk-MGGEGWLF.js";import"./chunk-OAACOBQM.js";import"./chunk-JWIEPCRG.js";import"./chunk-HUAH4PE6.js";import"./chunk-SV7S5NYR.js";import"./chunk-C5RQ2IC2.js";import"./chunk-K5LNJG62.js";import"./chunk-THTBSZJO.js";import"./chunk-GNOVVPTF.js";import"./chunk-BAKMWPBW.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import{g as P}from"./chunk-OLRFWS6T.js";function oe(n,r){n&1&&g(0,"ion-spinner",18)}function ne(n,r){n&1&&(o(0,"span"),l(1),d(2,"translate"),i()),n&2&&(e(),m(p(2,1,"AUTH.RESET_PASSWORD")))}function se(n,r){if(n&1&&(o(0,"ion-text",19)(1,"p",20),l(2),d(3,"translate"),i()()),n&2){let w=S();e(2),m(p(3,1,w.errorMessage))}}function re(n,r){if(n&1&&(o(0,"ion-text",21)(1,"p",20),l(2),d(3,"translate"),i()()),n&2){let w=S();e(2),m(p(3,1,w.successMessage))}}var Re=(()=>{let r=class r{constructor(a,f){this.auth=a,this.router=f,this.email="",this.newPassword="",this.confirmPassword="",this.showPassword=!1,this.showConfirmPassword=!1,this.errorMessage="",this.successMessage="",this.isLoading=!1,this.oobCode=null}ngOnInit(){let a=new URLSearchParams(window.location.search);this.oobCode=a.get("oobCode"),this.oobCode&&this.verifyResetCode()}verifyResetCode(){return P(this,null,function*(){try{let a=yield U(this.auth,this.oobCode);this.email=a}catch{this.errorMessage="AUTH.ERRORS.INVALID_RESET_CODE",setTimeout(()=>{this.router.navigate(["/auth/email"])},3e3)}})}resetPassword(){return P(this,null,function*(){if(!this.oobCode){this.errorMessage="AUTH.ERRORS.INVALID_RESET_CODE";return}if(!this.newPassword||!this.confirmPassword){this.errorMessage="AUTH.ERRORS.EMPTY_FIELDS";return}if(!ie(this.newPassword,this.confirmPassword)){this.errorMessage="AUTH.ERRORS.PASSWORDS_DONT_MATCH";return}if(!te(this.newPassword)){this.errorMessage="AUTH.ERRORS.PASSWORD_REQUIREMENTS";return}this.isLoading=!0,this.errorMessage="",this.successMessage="";try{yield O(this.auth,this.oobCode,this.newPassword),this.successMessage="AUTH.RESET_SUCCESS",setTimeout(()=>{this.router.navigate(["/auth/email"])},3e3)}catch(a){switch(a.code){case"auth/expired-action-code":this.errorMessage="AUTH.ERRORS.EXPIRED_RESET_CODE";break;case"auth/invalid-action-code":this.errorMessage="AUTH.ERRORS.INVALID_RESET_CODE";break;case"auth/weak-password":this.errorMessage="AUTH.ERRORS.WEAK_PASSWORD";break;default:this.errorMessage="AUTH.ERRORS.UNKNOWN"}}finally{this.isLoading=!1}})}togglePasswordVisibility(){this.showPassword=!this.showPassword}toggleConfirmPasswordVisibility(){this.showConfirmPassword=!this.showConfirmPassword}};r.\u0275fac=function(f){return new(f||r)(_(A),_(x))},r.\u0275cmp=T({type:r,selectors:[["app-reset-password-confirmation"]],decls:44,vars:30,consts:[["slot","start"],["defaultHref","/auth/email"],[1,"ion-padding"],[2,"text-align","center","margin-bottom","16px"],["src","assets/bob/logo/bob-logo-circle.png","alt","BoB Logo",2,"height","70px","margin-bottom","8px"],["color","medium",1,"ion-text-center"],["position","floating"],["type","email","readonly","",3,"value"],["name","newPassword","required","",3,"ngModelChange","type","ngModel"],["fill","clear","slot","end","type","button",3,"click"],[3,"name"],["name","confirmPassword","required","",3,"ngModelChange","type","ngModel"],["expand","block",3,"click","disabled"],["name","crescent",4,"ngIf"],[4,"ngIf"],["color","danger",4,"ngIf"],["color","success",4,"ngIf"],[1,"ion-padding-top"],["name","crescent"],["color","danger"],[1,"ion-text-center"],["color","success"]],template:function(f,t){f&1&&(o(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),g(3,"ion-back-button",1),i(),o(4,"ion-title"),l(5),d(6,"translate"),i()()(),o(7,"ion-content",2)(8,"div",3),g(9,"img",4),i(),o(10,"ion-text",5)(11,"p"),l(12),d(13,"translate"),i()(),o(14,"ion-list")(15,"ion-item")(16,"ion-label",6),l(17),d(18,"translate"),i(),g(19,"ion-input",7),i(),o(20,"ion-item")(21,"ion-label",6),l(22),d(23,"translate"),i(),o(24,"ion-input",8),I("ngModelChange",function(c){return C(t.newPassword,c)||(t.newPassword=c),c}),i(),o(25,"ion-button",9),h("click",function(){return t.togglePasswordVisibility()}),g(26,"ion-icon",10),i()(),o(27,"ion-item")(28,"ion-label",6),l(29),d(30,"translate"),i(),o(31,"ion-input",11),I("ngModelChange",function(c){return C(t.confirmPassword,c)||(t.confirmPassword=c),c}),i(),o(32,"ion-button",9),h("click",function(){return t.toggleConfirmPasswordVisibility()}),g(33,"ion-icon",10),i()()(),o(34,"div",2)(35,"ion-button",12),h("click",function(){return t.resetPassword()}),R(36,oe,1,0,"ion-spinner",13)(37,ne,3,3,"span",14),i()(),R(38,se,4,3,"ion-text",15)(39,re,4,3,"ion-text",16),o(40,"ion-text",5)(41,"p",17),l(42),d(43,"translate"),i()()()),f&2&&(e(5),m(p(6,18,"AUTH.RESET_PASSWORD_TITLE")),e(7),m(p(13,20,"AUTH.RESET_PASSWORD_INSTRUCTIONS")),e(5),m(p(18,22,"AUTH.EMAIL")),e(2),s("value",t.email),e(3),m(p(23,24,"AUTH.NEW_PASSWORD")),e(2),s("type",t.showPassword?"text":"password"),E("ngModel",t.newPassword),e(2),s("name",t.showPassword?"eye-off":"eye"),e(3),m(p(30,26,"AUTH.CONFIRM_PASSWORD")),e(2),s("type",t.showConfirmPassword?"text":"password"),E("ngModel",t.confirmPassword),e(2),s("name",t.showConfirmPassword?"eye-off":"eye"),e(2),s("disabled",t.isLoading),e(),s("ngIf",t.isLoading),e(),s("ngIf",!t.isLoading),e(),s("ngIf",t.errorMessage),e(),s("ngIf",t.successMessage),e(3),M(" ",p(43,28,"AUTH.PASSWORD_REQUIREMENTS")," "))},dependencies:[b,y,$,k,N,V,F,q,j,K,Q,X,Y,z,G,J,B,Z,W,D,L,H,ee,v],styles:["ion-content[_ngcontent-%COMP%]{--background: var(--ion-color-light)}ion-text[color=success][_ngcontent-%COMP%]{color:var(--ion-color-success)}ion-text[color=danger][_ngcontent-%COMP%]{color:var(--ion-color-danger)}ion-text[color=medium][_ngcontent-%COMP%]{color:var(--ion-color-medium)}.ion-padding-top[_ngcontent-%COMP%]{padding-top:16px}"]});let n=r;return n})();export{Re as ResetPasswordConfirmationPage};
