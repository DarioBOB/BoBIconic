import{a as g,e as w,f as b,k as n}from"./chunk-PJ4DBHJV.js";import{D as u,E as l,F as d,M as p,P as f,Q as a,R as m}from"./chunk-HLI2QS3U.js";import{b as h,m as c,q as s}from"./chunk-GCV73WN4.js";import{g as r}from"./chunk-OLRFWS6T.js";var D=(()=>{let e=class e{constructor(){this.auth=s(d),this.firestore=s(g),this.userSubject=new h(null),this.user$=this.userSubject.asObservable(),p(this.auth,t=>{this.userSubject.next(t),t&&this.ensureUserProfile(t)})}loginWithEmail(t,i){return r(this,null,function*(){return f(this.auth,t,i)})}loginWithGoogle(){return r(this,null,function*(){let t=new l;return a(this.auth,t)})}loginWithFacebook(){return r(this,null,function*(){let t=new u;return a(this.auth,t)})}logout(){return r(this,null,function*(){yield m(this.auth)})}ensureUserProfile(t){return r(this,null,function*(){let i=w(this.firestore,`users/${t.uid}`);(yield b(i)).exists()?yield n(i,{lastLogin:new Date},{merge:!0}):yield n(i,{uid:t.uid,email:t.email,displayName:t.displayName,photoUrl:t.photoURL,provider:t.providerId,createdAt:new Date,lastLogin:new Date})})}get currentUser(){return this.auth.currentUser}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=c({token:e,factory:e.\u0275fac,providedIn:"root"});let o=e;return o})();export{D as a};
